generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model accounts {
  id        Int           @id @default(autoincrement())
  user_code String        @unique(map: "user_code") @db.VarChar(20)
  password  String        @db.VarChar(255)
  role      accounts_role
  students  students[]
  teachers  teachers[]
}

model announcements {
  id         Int       @id @default(autoincrement())
  title      String    @db.VarChar(200)
  content    String    @db.Text
  created_at DateTime? @default(now()) @db.Timestamp(0)
}

model students {
  student_id String    @id @db.VarChar(20)
  full_name  String    @db.VarChar(100)
  course     String    @db.VarChar(10)
  classes    String?   @db.VarChar(255)
  account_id Int?
  accounts   accounts? @relation(fields: [account_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "students_ibfk_1")
  created_at DateTime? @default(now()) @db.Timestamp(0)

  @@index([account_id], map: "account_id")
}

model teachers {
  teacher_id String    @id @db.VarChar(20)
  full_name  String    @db.VarChar(100)
  subject    String    @db.VarChar(100)
  classes    String?   @db.VarChar(255)
  account_id Int?
  accounts   accounts? @relation(fields: [account_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "teachers_ibfk_1")
  created_at DateTime? @default(now()) @db.Timestamp(0)

  @@index([account_id], map: "account_id")
}

model time_slots {
  slot_id    Int         @id
  start_time DateTime    @db.Time(0)
  end_time   DateTime    @db.Time(0)
  timetable  timetable[]
}

model timetable {
  id          Int                   @id @default(autoincrement())
  classes     String                @db.VarChar(100)
  day_of_week timetable_day_of_week
  slot_id     Int
  room        String                @db.VarChar(50)
  time_slots  time_slots            @relation(fields: [slot_id], references: [slot_id], onDelete: Cascade, map: "timetable_ibfk_1")

  @@index([slot_id], map: "slot_id")
}

model semester_attendance_stats {
  id               Int      @id @default(autoincrement())
  code             String   @db.VarChar(20)
  name             String   @db.VarChar(100)
  total_students   Int
  attendance_ratio Float
  updated_at       DateTime @default(now()) @db.Timestamp(0)

  @@unique([code])
}

enum timetable_day_of_week {
  Mon
  Tue
  Wed
  Thu
  Fri
  Sat
  Sun
}

enum accounts_role {
  student
  teacher
  admin
}
